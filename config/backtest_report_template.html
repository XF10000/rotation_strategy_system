<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ ä¸­çº¿è½®åŠ¨ç­–ç•¥å¢å¼ºç‰ˆå›æµ‹æŠ¥å‘Š</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #1a202c;
            background: #f8fafc;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }
        
        .header {
            background: #ffffff;
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            margin-bottom: 32px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        .header h1 {
            font-size: 2.25rem;
            color: #2d3748;
            margin-bottom: 12px;
            font-weight: 700;
        }
        
        .section {
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }
        
        .section h2 {
            color: #1a202c;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 12px;
            margin-bottom: 24px;
            font-size: 1.375rem;
            font-weight: 600;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .metric-card {
            background: #f7fafc;
            color: #1a202c;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .metric-card:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }
        
        .metric-card h3 {
            font-size: 0.875rem;
            color: #4a5568;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .metric-card .value {
            font-size: 1.75rem;
            font-weight: 700;
            color: #2d3748;
        }
        
        .kline-section {
            margin-bottom: 30px;
        }
        
        .stock-selector {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stock-selector select {
            padding: 12px 16px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            color: #2d3748;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }
        
        .stock-selector select:hover {
            border-color: #a0aec0;
        }
        
        .stock-selector select:focus {
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }
        
        #klineChart {
            width: 100%;
            height: 800px;
            border-radius: 8px;
            background: white;
            border: 1px solid #e2e8f0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        th, td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #f1f5f9;
        }
        
        th {
            background: #f8fafc;
            color: #374151;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        tr:hover {
            background-color: #f8fafc;
        }
        
        tbody tr:last-child td {
            border-bottom: none;
        }
        
        .buy-row {
            background-color: #f0fff4;
        }
        
        .sell-row {
            background-color: #fed7d7;
        }
        
        .signal-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }
        
        .signal-card {
            background: #f8fafc;
            color: #1a202c;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .signal-card:hover {
            background: #f1f5f9;
            border-color: #cbd5e0;
        }
        
        .signal-card h4 {
            margin-bottom: 16px;
            font-size: 1rem;
            font-weight: 600;
            color: #2d3748;
        }
        
        .signal-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.875rem;
        }
        
        .signal-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .final-portfolio-status {
            margin: 20px 0;
            padding: 0;
        }
        
        .portfolio-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .summary-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e0;
        }
        
        .summary-label {
            font-weight: 500;
            color: #4a5568;
            font-size: 0.875rem;
        }
        
        .summary-value {
            color: #1a202c;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .stock-positions {
            margin-top: 20px;
        }
        
        .stock-positions h4 {
            color: #1a202c;
            margin-bottom: 16px;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .positions-table {
            width: 100%;
            margin-top: 16px;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .positions-table th,
        .positions-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .positions-table th {
            background: #f8fafc;
            color: #374151;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .positions-table tbody tr:hover {
            background-color: #f8fafc;
        }
        
        .positions-table tbody tr:last-child td {
            border-bottom: none;
        }

        .benchmark-comparison {
            margin: 20px 0;
        }
        
        .comparison-summary {
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .comparison-summary.outperform {
            background: #f0fff4;
            border: 1px solid #c6f6d5;
            color: #22543d;
        }
        
        .comparison-summary.underperform {
            background: #fef5e7;
            border: 1px solid #fed7aa;
            color: #9c4221;
        }
        
        .comparison-table .outperform {
            color: #059669;
            font-weight: 600;
        }
        
        .comparison-table .underperform {
            color: #dc2626;
            font-weight: 600;
        }
        
        .performance-analysis {
            background: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #e2e8f0;
        }
        
        .final-portfolio-status {
            margin: 20px 0;
            padding: 0;
        }
        
        .portfolio-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .summary-label {
            font-weight: 500;
            color: #4a5568;
            font-size: 0.875rem;
        }
        
        .summary-value {
            color: #1a202c;
            font-weight: 600;
            font-size: 0.875rem;
        }
        .positive { color: #e53e3e; font-weight: bold; }
        .negative { color: #38a169; font-weight: bold; }
        .signal-check { color: #38a169; font-weight: bold; }
        .signal-cross { color: #e53e3e; font-weight: bold; }
        .signal-neutral { color: #718096; }
        .bb-position { font-size: 10px; color: #4a5568; }

        .global-summary {
            margin-bottom: 30px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .summary-card {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .summary-card:hover {
            background: #f1f5f9;
            border-color: #cbd5e0;
        }
        
        .summary-card.total {
            border-left: 4px solid #3182ce;
        }
        
        .summary-card.buy {
            border-left: 4px solid #059669;
        }
        
        .summary-card.sell {
            border-left: 4px solid #dc2626;
        }
        
        .summary-card.ratio {
            border-left: 4px solid #7c3aed;
        }
        
        .summary-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 4px;
            color: #1a202c;
        }
        
        .summary-title {
            font-size: 0.875rem;
            color: #4a5568;
            font-weight: 500;
        }
        
        .dimension-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin: 20px 0;
        }
        
        .dim-summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.2s ease;
        }
        
        .dim-summary-item:hover {
            background: #f1f5f9;
            border-color: #cbd5e0;
        }
        
        .dim-name {
            font-weight: 500;
            color: #2d3748;
            font-size: 0.875rem;
        }
        
        .dim-count {
            font-weight: 600;
            color: #1a202c;
            font-size: 0.875rem;
        }
        
        .dim-rate {
            color: #6b7280;
            font-size: 0.75rem;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ä¸­çº¿è½®åŠ¨ç­–ç•¥å¢å¼ºç‰ˆå›æµ‹æŠ¥å‘Š</h1>
            <p>ç”Ÿæˆæ—¶é—´: 2025-07-26 17:54:46</p>
            <p>åŒ…å«æŠ€æœ¯æŒ‡æ ‡è¯¦æƒ…ä¸4ç»´ä¿¡å·åˆ†æ</p>
        </div>
        
        <!-- Kçº¿å›¾ä¸äº¤æ˜“ç‚¹åˆ†æ -->
        <div class="section kline-section">
            <h2>ğŸ“Š å‘¨Kçº¿å›¾ä¸äº¤æ˜“ç‚¹åˆ†æ</h2>
            <div class="stock-selector">
                <label for="stockSelect">é€‰æ‹©è‚¡ç¥¨: </label>
                <select id="stockSelect" onchange="updateKlineChart()">
                    <option value="">è¯·é€‰æ‹©è‚¡ç¥¨</option>
                </select>
            </div>
            <div id="klineChart"></div>
        </div>
        
        <!-- åŸºç¡€æŒ‡æ ‡ -->
        <div class="section">
            <h2>ğŸ“ˆ åŸºç¡€å›æµ‹æŒ‡æ ‡</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>åˆå§‹èµ„é‡‘</h3>
                    <div class="value">Â¥1,000,000</div>
                </div>
                <div class="metric-card">
                    <h3>æœ€ç»ˆèµ„é‡‘</h3>
                    <div class="value">Â¥1,680,939</div>
                </div>
                <div class="metric-card">
                    <h3>æ€»æ”¶ç›Šç‡</h3>
                    <div class="value">68.09%</div>
                </div>
                <div class="metric-card">
                    <h3>å¹´åŒ–æ”¶ç›Šç‡</h3>
                    <div class="value">18.47%</div>
                </div>
                <div class="metric-card">
                    <h3>æœ€å¤§å›æ’¤</h3>
                    <div class="value">-21.56%</div>
                </div>
            </div>
        </div>
        
        <!-- ç­–ç•¥ä¸åŸºå‡†å¯¹æ¯” -->
        <div class="section">
            <h2>ğŸ“Š ç­–ç•¥ vs ä¹°å…¥æŒæœ‰åŸºå‡†å¯¹æ¯”</h2>
            <div class="comparison-summary outperform">
                <h4>ğŸ“ˆ ç­–ç•¥è¡¨ç°ä¼˜äºåŸºå‡†</h4>
                <p>ç­–ç•¥æ€»æ”¶ç›Šç‡ <strong>68.09%</strong> è¶…è¶ŠåŸºå‡†æ”¶ç›Šç‡ <strong>45.0%</strong></p>
                <p>è¶…é¢æ”¶ç›Š: <strong>+23.09%</strong></p>
            </div>
            
            <div class="comparison-table">
                <table>
                    <thead>
                        <tr>
                            <th>æŒ‡æ ‡</th>
                            <th>ç­–ç•¥è¡¨ç°</th>
                            <th>åŸºå‡†è¡¨ç°</th>
                            <th>è¶…é¢æ”¶ç›Š</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>æ€»æ”¶ç›Šç‡</td>
                            <td>68.09%</td>
                            <td>45.0%</td>
                            <td>+23.09%</td>
                        </tr>
                        <tr>
                            <td>å¹´åŒ–æ”¶ç›Šç‡</td>
                            <td>18.47%</td>
                            <td>12.0%</td>
                            <td>+6.47%</td>
                        </tr>
                        <tr>
                            <td>æœ€å¤§å›æ’¤</td>
                            <td>-21.56%</td>
                            <td>-15.0%</td>
                            <td>-6.56%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- æœ€ç»ˆæŒä»“çŠ¶æ€ -->
        <div class="section">
            <h2>ğŸ’¼ å›æµ‹ç»“æŸæ—¶æŒä»“çŠ¶æ€</h2>
            <div class="portfolio-summary">
                <div class="summary-item">
                    <span class="summary-label">æ€»èµ„äº§:</span>
                    <span class="summary-value">Â¥60,606,734.62</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">ç°é‡‘:</span>
                    <span class="summary-value">Â¥8,613,805.62 (14.2%)</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">è‚¡ç¥¨å¸‚å€¼:</span>
                    <span class="summary-value">Â¥51,992,929.00 (85.8%)</span>
                </div>
            </div>
            
            <div class="stock-positions">
                <h4>ğŸ“Š è‚¡ç¥¨æŒä»“æ˜ç»†</h4>
        
                <table class="positions-table">
                    <thead>
                        <tr>
                            <th>è‚¡ç¥¨ä»£ç </th>
                            <th>æŒè‚¡æ•°é‡</th>
                            <th>å½“å‰ä»·æ ¼</th>
                            <th>å¸‚å€¼</th>
                            <th>å æ¯”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>600985</td>
                            <td>1,200,000</td>
                            <td>Â¥12.85</td>
                            <td>Â¥15,420,000.00</td>
                            <td>25.4%</td>
                        </tr>
                        <tr>
                            <td>601088</td>
                            <td>900,000</td>
                            <td>Â¥40.64</td>
                            <td>Â¥36,572,929.00</td>
                            <td>60.4%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- ä¹°å…¥æŒæœ‰åŸºå‡†æŒä»“çŠ¶æ€ -->
        <div class="section">
            <h2>ğŸ“Š å›æµ‹ç»“æŸæ—¶ä¹°å…¥æŒæœ‰åŸºå‡†æŒä»“çŠ¶æ€</h2>
            <div class="portfolio-summary">
                <div class="summary-item">
                    <span class="summary-label">æ€»èµ„äº§:</span>
                    <span class="summary-value">Â¥BENCHMARK_TOTAL_VALUE</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">ç°é‡‘:</span>
                    <span class="summary-value">Â¥BENCHMARK_CASH (BENCHMARK_CASH_RATIO%)</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">è‚¡ç¥¨å¸‚å€¼:</span>
                    <span class="summary-value">Â¥BENCHMARK_STOCK_VALUE (BENCHMARK_STOCK_RATIO%)</span>
                </div>
            </div>
            
            <div class="stock-positions">
                <h4>ğŸ“Š åŸºå‡†è‚¡ç¥¨æŒä»“æ˜ç»†</h4>
        
                <table class="position-comparison-table">
                    <thead>
                        <tr>
                            <th rowspan="2">è‚¡ç¥¨ä»£ç </th>
                            <th colspan="4">å›æµ‹èµ·å§‹æ—¥</th>
                            <th colspan="4">å›æµ‹ç»“æŸæ—¥</th>
                            <th colspan="3">å˜åŒ–æƒ…å†µ</th>
                        </tr>
                        <tr>
                            <th>æŒè‚¡æ•°é‡</th>
                            <th>ä»·æ ¼</th>
                            <th>å¸‚å€¼</th>
                            <th>å æ¯”</th>
                            <th>æŒè‚¡æ•°é‡</th>
                            <th>ä»·æ ¼</th>
                            <th>å¸‚å€¼</th>
                            <th>å æ¯”</th>
                            <th>æŒè‚¡å˜åŒ–</th>
                            <th>å¸‚å€¼å˜åŒ–</th>
                            <th>æ”¶ç›Šç‡</th>
                        </tr>
                    </thead>
                    <tbody>
                        BENCHMARK_POSITION_COMPARISON_TABLE
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- äº¤æ˜“æŒ‡æ ‡ -->
        <div class="section">
            <h2>ğŸ’¼ äº¤æ˜“ç»Ÿè®¡æŒ‡æ ‡</h2>
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>æ€»äº¤æ˜“æ¬¡æ•°</h3>
                    <div class="value">7</div>
                </div>
                <div class="metric-card">
                    <h3>ä¹°å…¥æ¬¡æ•°</h3>
                    <div class="value">0</div>
                </div>
                <div class="metric-card">
                    <h3>å–å‡ºæ¬¡æ•°</h3>
                    <div class="value">7</div>
                </div>
                <div class="metric-card">
                    <h3>æ€»æ‰‹ç»­è´¹</h3>
                    <div class="value">0.0:1</div>
                </div>
                <div class="metric-card">
                    <h3>æ‰‹ç»­è´¹ç‡</h3>
                    <div class="value">0.1%</div>
                </div>
            </div>
        </div>
        
        <!-- è¯¦ç»†äº¤æ˜“è®°å½• -->
        <div class="section">
            <h2>ğŸ“‹ è¯¦ç»†äº¤æ˜“è®°å½•ï¼ˆ4ç»´ä¿¡å·çŠ¶æ€åˆ†æï¼‰</h2>
            <div class="transaction-summary">
                <p><strong>ğŸ“‹ äº¤æ˜“è®°å½•æ€»è§ˆ</strong></p>
                <ul>
                    <li>ğŸ”´ <strong>å–å‡ºä¿¡å·</strong>: 7æ¬¡ - ä¸»è¦ç”±ä»·å€¼æ¯”è¿‡æ»¤å™¨+è¶…ä¹°è¶…å–ä¿¡å·è§¦å‘</li>
                    <li>ğŸŸ¢ <strong>ä¹°å…¥ä¿¡å·</strong>: 0æ¬¡ - å½“å‰å›æµ‹æœŸå†…æ— ä¹°å…¥æ“ä½œ</li>
                    <li>ğŸ“Š <strong>ä¿¡å·ç»´åº¦</strong>: ä»·å€¼æ¯”è¿‡æ»¤å™¨ã€RSIä¿¡å·ã€MACDä¿¡å·ã€å¸ƒæ—å¸¦é‡èƒ½ä¿¡å·</li>
                    <li>âš¡ <strong>ä¿¡å·è§¦å‘</strong>: å¹³å‡æ¯æ¬¡äº¤æ˜“æ»¡è¶³2-3ä¸ªç»´åº¦æ¡ä»¶</li>
                </ul>
            </div>
            
            <div class="transaction-details">
                <h4>ğŸ“ˆ è¯¦ç»†äº¤æ˜“è®°å½•</h4>
                <!-- äº¤æ˜“è®°å½•è¡¨æ ¼å°†ç”±Pythonä»£ç åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- ä¿¡å·ç»Ÿè®¡åˆ†æ -->
        <div class="section">
            <h2>ğŸ“Š ä¿¡å·ç»Ÿè®¡åˆ†æ</h2>
            <div class="signal-stats-grid">
                <div class="signal-stat-card">
                    <h4>ğŸ’° ä»·å€¼æ¯”è¿‡æ»¤å™¨</h4>
                    <div class="stat-value">100%</div>
                    <div class="stat-desc">æ‰€æœ‰äº¤æ˜“éƒ½é€šè¿‡ä»·å€¼æ¯”è¿‡æ»¤</div>
                </div>
                
                <div class="signal-stat-card">
                    <h4>ğŸ“‰ RSIä¿¡å·</h4>
                    <div class="stat-value">85.7%</div>
                    <div class="stat-desc">6/7æ¬¡äº¤æ˜“æ»¡è¶³RSIæ¡ä»¶</div>
                </div>
                
                <div class="signal-stat-card">
                    <h4>âš¡ MACDä¿¡å·</h4>
                    <div class="stat-value">71.4%</div>
                    <div class="stat-desc">5/7æ¬¡äº¤æ˜“æ»¡è¶³MACDæ¡ä»¶</div>
                </div>
                
                <div class="signal-stat-card">
                    <h4>ğŸ“Š å¸ƒæ—å¸¦é‡èƒ½</h4>
                    <div class="stat-value">28.6%</div>
                    <div class="stat-desc">2/7æ¬¡äº¤æ˜“æ»¡è¶³é‡èƒ½æ¡ä»¶</div>
                </div>
            </div>
            
            <div class="signal-analysis-summary">
                <h4>ğŸ“Š ä¿¡å·ç»Ÿè®¡åˆ†æ</h4>
                <ul>
                    <li><strong>ä¸»è¦ä¿¡å·æº</strong>: ä»·å€¼æ¯”è¿‡æ»¤å™¨(100%) + RSIè¶…ä¹°è¶…å–(85.7%)æ˜¯æœ€é‡è¦çš„äº¤æ˜“ä¿¡å·</li>
                    <li><strong>MACDç¡®è®¤</strong>: 71.4%çš„äº¤æ˜“è·å¾—MACDåŠ¨èƒ½ç¡®è®¤ï¼Œæé«˜ä¿¡å·è´¨é‡</li>
                    <li><strong>é‡èƒ½è¿‡æ»¤</strong>: ä»…28.6%çš„äº¤æ˜“æ»¡è¶³æç«¯é‡èƒ½æ¡ä»¶ï¼Œè¯´æ˜å¸‚åœºçŠ¶æ€ç›¸å¯¹ç¨³å®š</li>
                    <li><strong>ä¿¡å·è´¨é‡</strong>: å¹³å‡æ¯æ¬¡äº¤æ˜“æ»¡è¶³2.6ä¸ªç»´åº¦ï¼Œä¿¡å·è´¨é‡è¾ƒé«˜</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Kçº¿æ•°æ®
        const klineData = {};
        
        // åˆå§‹åŒ–å›¾è¡¨
        const klineChart = echarts.init(document.getElementById('klineChart'));
        
        // è‚¡ç¥¨ä»£ç åˆ°è‚¡ç¥¨åç§°çš„æ˜ å°„
        const stockNameMapping = {
            '601088': 'ä¸­å›½ç¥å',
            '601225': 'é™•è¥¿ç…¤ä¸š',
            '600985': 'æ·®åŒ—çŸ¿ä¸š',
            '002738': 'ä¸­çŸ¿èµ„æº',
            '002460': 'èµ£é”‹é”‚ä¸š',
            '000933': 'ç¥ç«è‚¡ä»½',
            '000807': 'äº‘é“è‚¡ä»½',
            '600079': 'äººç¦åŒ»è¯',
            '603345': 'å®‰äº•é£Ÿå“',
            '601898': 'ä¸­ç…¤èƒ½æº'
        };
        
        // è·å–è‚¡ç¥¨æ˜¾ç¤ºåç§°
        function getStockDisplayName(stockCode) {
            const stockName = stockNameMapping[stockCode];
            return stockName ? `${stockName}(${stockCode})` : stockCode;
        }
        
        // åˆå§‹åŒ–è‚¡ç¥¨é€‰æ‹©å™¨
        function initStockSelector() {
            const select = document.getElementById('stockSelect');
            const stocks = Object.keys(klineData);
            
            console.log('å¯ç”¨è‚¡ç¥¨:', stocks);
            
            stocks.forEach(stock => {
                const option = document.createElement('option');
                option.value = stock;  // ä¿æŒvalueä¸ºè‚¡ç¥¨ä»£ç 
                option.textContent = getStockDisplayName(stock);  // æ˜¾ç¤ºè‚¡ç¥¨åç§°
                select.appendChild(option);
            });
            
            // å¦‚æœæœ‰è‚¡ç¥¨æ•°æ®ï¼Œé»˜è®¤é€‰æ‹©ç¬¬ä¸€ä¸ª
            if (stocks.length > 0) {
                select.value = stocks[0];
                updateKlineChart();
            }
        }
        
        function updateKlineChart() {
            const selectedStock = document.getElementById('stockSelect').value;
            if (!selectedStock || !klineData[selectedStock]) {
                console.log('æœªé€‰æ‹©è‚¡ç¥¨æˆ–æ— æ•°æ®');
                return;
            }
            
            const stockData = klineData[selectedStock];
            const klinePoints = stockData.kline || [];
            const tradePoints = stockData.trades || [];
            
            console.log('Kçº¿æ•°æ®ç‚¹æ•°:', klinePoints.length);
            console.log('äº¤æ˜“ç‚¹æ•°:', tradePoints.length);
            
            // å‡†å¤‡ä¹°å–ç‚¹æ•°æ®
            const buyPoints = [];
            const sellPoints = [];
            
            // è®¡ç®—ä¹°å–ç‚¹åœ¨æ—¶é—´è½´åº•éƒ¨çš„æ˜¾ç¤ºä½ç½®
            let minPrice = Math.min(...klinePoints.map(point => point[3])); // è·å–æ‰€æœ‰Kçº¿çš„æœ€ä½ä»·
            let maxPrice = Math.max(...klinePoints.map(point => point[2])); // è·å–æ‰€æœ‰Kçº¿çš„æœ€é«˜ä»·
            let priceRange = maxPrice - minPrice; // ä»·æ ¼èŒƒå›´
            let buyYPosition = minPrice - priceRange * 0.15; // ä¹°å…¥ç‚¹åœ¨æœ€ä½ä»·ä¸‹æ–¹15%çš„ä½ç½®
            let sellYPosition = minPrice - priceRange * 0.2; // å–å‡ºç‚¹åœ¨æœ€ä½ä»·ä¸‹æ–¹20%çš„ä½ç½®
            
            tradePoints.forEach(trade => {
                if (trade.type === 'BUY') {
                    buyPoints.push([trade.timestamp, buyYPosition]);
                } else {
                    sellPoints.push([trade.timestamp, sellYPosition]);
                }
            });
            
            // ğŸ†• å‡†å¤‡æœªæ‰§è¡Œä¿¡å·æ•°æ®
            const unexecutedBuyPoints = [];
            const unexecutedSellPoints = [];
            let unexecutedBuyYPosition = maxPrice + priceRange * 0.15; // æœªæ‰§è¡Œä¹°å…¥ç‚¹åœ¨æœ€é«˜ä»·ä¸Šæ–¹15%çš„ä½ç½®
            let unexecutedSellYPosition = maxPrice + priceRange * 0.1; // æœªæ‰§è¡Œå–å‡ºç‚¹åœ¨æœ€é«˜ä»·ä¸Šæ–¹10%çš„ä½ç½®
            
            if (typeof unexecutedSignals !== 'undefined' && unexecutedSignals[selectedStock]) {
                console.log('å¤„ç†æœªæ‰§è¡Œä¿¡å·ï¼Œè‚¡ç¥¨:', selectedStock, 'ä¿¡å·æ•°é‡:', unexecutedSignals[selectedStock].length);
                unexecutedSignals[selectedStock].forEach(signal => {
                    const signalTimestamp = new Date(signal.date).getTime();
                    console.log('æœªæ‰§è¡Œä¿¡å·:', signal.date, 'æ—¶é—´æˆ³:', signalTimestamp, 'ç±»å‹:', signal.signal_type);
                    
                    // å¯»æ‰¾æœ€æ¥è¿‘çš„Kçº¿æ•°æ®ç‚¹æ—¶é—´æˆ³
                    let closestTimestamp = null;
                    let minDiff = Infinity;
                    klinePoints.forEach(kpoint => {
                        const diff = Math.abs(kpoint[0] - signalTimestamp);
                        if (diff < minDiff) {
                            minDiff = diff;
                            closestTimestamp = kpoint[0];
                        }
                    });
                    
                    // å¦‚æœæ‰¾åˆ°ç›¸è¿‘çš„æ—¶é—´æˆ³ï¼ˆ7å¤©å†…ï¼‰ï¼Œä½¿ç”¨è¯¥æ—¶é—´æˆ³
                    if (closestTimestamp && minDiff <= 7 * 24 * 60 * 60 * 1000) {
                        console.log('æ‰¾åˆ°åŒ¹é…çš„Kçº¿æ—¶é—´æˆ³:', new Date(closestTimestamp), 'å·®å¼‚:', minDiff / (24 * 60 * 60 * 1000), 'å¤©');
                        if (signal.signal_type === 'BUY') {
                            unexecutedBuyPoints.push([closestTimestamp, unexecutedBuyYPosition, signal.reason]);
                        } else if (signal.signal_type === 'SELL') {
                            unexecutedSellPoints.push([closestTimestamp, unexecutedSellYPosition, signal.reason]);
                        }
                    } else {
                        console.log('æœªæ‰¾åˆ°åŒ¹é…çš„Kçº¿æ—¶é—´æˆ³ï¼Œä¿¡å·æ—¶é—´:', signal.date, 'æœ€å°å·®å¼‚:', minDiff / (24 * 60 * 60 * 1000), 'å¤©');
                    }
                });
                console.log('æœªæ‰§è¡Œä¹°å…¥ç‚¹:', unexecutedBuyPoints.length, 'æœªæ‰§è¡Œå–å‡ºç‚¹:', unexecutedSellPoints.length);
            }
            
            // å‡†å¤‡å¸ƒæ—å¸¦æ•°æ®
            const bbUpperPoints = stockData.bb_upper || [];
            const bbLowerPoints = stockData.bb_lower || [];
            const bbMiddlePoints = stockData.bb_middle || [];
            
            // å‡†å¤‡ä»·å€¼æ¯”æ•°æ®
            const pvrPoints = stockData.pvr || [];
            
            // å‡†å¤‡RSIæ•°æ®
            const rsiPoints = stockData.rsi || [];
            
            // å‡†å¤‡MACDæ•°æ®
            const macdPoints = stockData.macd ? stockData.macd.dif || [] : [];
            const macdSignalPoints = stockData.macd ? stockData.macd.dea || [] : [];
            const macdHistogramPoints = stockData.macd ? stockData.macd.histogram || [] : [];
            
            // ğŸ†• å‡†å¤‡åˆ†çº¢æ ‡å¿—æ•°æ® - æ˜¾ç¤ºåœ¨æ—¶é—´è½´åº•éƒ¨
            const dividendPoints = [];
            if (stockData.dividends && stockData.dividends.length > 0) {
                // åˆ†çº¢æ ‡å¿—åœ¨æœ€ä½ä»·ä¸‹æ–¹25%çš„ä½ç½®æ˜¾ç¤ºï¼Œé¿å…ä¸ä¹°å–ç‚¹é‡å 
                let dividendYPosition = minPrice - priceRange * 0.25;
                
                stockData.dividends.forEach(dividend => {
                    dividendPoints.push([dividend.timestamp, dividendYPosition]);
                });
                console.log('åˆ†çº¢äº‹ä»¶æ•°é‡:', dividendPoints.length);
                console.log('åˆ†çº¢æ ‡å¿—æ˜¾ç¤ºä½ç½®:', dividendYPosition);
            }
            
            const option = {
                title: {
                    text: `${selectedStock} å‘¨Kçº¿å›¾`,
                    left: 'center'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        link: [
                            {
                                xAxisIndex: [0, 1, 2, 3]
                            }
                        ],
                        lineStyle: {
                            color: '#999',
                            width: 1,
                            type: 'dashed'
                        }
                    },
                    formatter: function(params) {
                        // è·å–å½“å‰è‚¡ç¥¨æ•°æ®
                        const selectedStock = document.getElementById('stockSelect').value;
                        const stockData = klineData[selectedStock];
                        
                        // è·å–å®Œæ•´æ—¥æœŸä¿¡æ¯ï¼ˆåŒ…å«æ—¥ï¼‰
                        let timeLabel = params[0].axisValueLabel; // é»˜è®¤ä½¿ç”¨è½´æ ‡ç­¾ï¼ˆå¹´-æœˆï¼‰
                        if (stockData && stockData.kline && params[0].dataIndex !== undefined) {
                            const dataIndex = params[0].dataIndex;
                            if (stockData.kline[dataIndex] && stockData.kline[dataIndex][0]) {
                                const fullDate = new Date(stockData.kline[dataIndex][0]);
                                timeLabel = `${fullDate.getFullYear()}-${String(fullDate.getMonth() + 1).padStart(2, '0')}-${String(fullDate.getDate()).padStart(2, '0')}`;
                            }
                        }
                        let result = timeLabel + '<br/>';
                        
                        if (stockData && params[0].dataIndex !== undefined) {
                            const dataIndex = params[0].dataIndex;
                            
                            // Kçº¿æ•°æ®
                            if (stockData.kline && stockData.kline[dataIndex]) {
                                const klineData = stockData.kline[dataIndex];
                                if (klineData && klineData.length >= 5) {
                                    result += 'ğŸ“ˆ <strong>Kçº¿æ•°æ®</strong><br/>';
                                    result += '&nbsp;&nbsp;å¼€ç›˜: ' + (klineData[1] ? klineData[1].toFixed(2) : 'N/A') + '<br/>';
                                    result += '&nbsp;&nbsp;æ”¶ç›˜: ' + (klineData[2] ? klineData[2].toFixed(2) : 'N/A') + '<br/>';
                                    result += '&nbsp;&nbsp;æœ€ä½: ' + (klineData[3] ? klineData[3].toFixed(2) : 'N/A') + '<br/>';
                                    result += '&nbsp;&nbsp;æœ€é«˜: ' + (klineData[4] ? klineData[4].toFixed(2) : 'N/A') + '<br/><br/>';
                                }
                            }
                            
                            // ä»·å€¼æ¯”æ•°æ®
                            if (stockData.pvr && stockData.pvr[dataIndex]) {
                                const pvrValue = stockData.pvr[dataIndex][1];
                                result += 'ğŸ’° <strong>ä»·å€¼æ¯”</strong><br/>';
                                result += '&nbsp;&nbsp;PVR: ' + (pvrValue ? pvrValue.toFixed(1) + '%' : 'N/A') + '<br/>';
                                
                                // æ·»åŠ ä¼°å€¼çŠ¶æ€åˆ¤æ–­
                                if (pvrValue) {
                                    if (pvrValue < 70) {
                                        result += '&nbsp;&nbsp;çŠ¶æ€: <span style="color: #2ed573;">æ·±åº¦ä½ä¼°</span><br/>';
                                    } else if (pvrValue < 100) {
                                        result += '&nbsp;&nbsp;çŠ¶æ€: <span style="color: #ffa500;">è½»åº¦ä½ä¼°</span><br/>';
                                    } else if (pvrValue > 120) {
                                        result += '&nbsp;&nbsp;çŠ¶æ€: <span style="color: #ff4757;">æ˜æ˜¾é«˜ä¼°</span><br/>';
                                    } else {
                                        result += '&nbsp;&nbsp;çŠ¶æ€: <span style="color: #333;">ä¼°å€¼åˆç†</span><br/>';
                                    }
                                }
                                result += '<br/>';
                            }
                            
                            // å¸ƒæ—å¸¦æ•°æ®
                            if (stockData.bb_upper && stockData.bb_upper[dataIndex] && 
                                stockData.bb_middle && stockData.bb_middle[dataIndex] && 
                                stockData.bb_lower && stockData.bb_lower[dataIndex]) {
                                result += 'ğŸ“Š <strong>å¸ƒæ—å¸¦</strong><br/>';
                                result += '&nbsp;&nbsp;ä¸Šè½¨: ' + (stockData.bb_upper[dataIndex][1] ? stockData.bb_upper[dataIndex][1].toFixed(2) : 'N/A') + '<br/>';
                                result += '&nbsp;&nbsp;ä¸­è½¨: ' + (stockData.bb_middle[dataIndex][1] ? stockData.bb_middle[dataIndex][1].toFixed(2) : 'N/A') + '<br/>';
                                result += '&nbsp;&nbsp;ä¸‹è½¨: ' + (stockData.bb_lower[dataIndex][1] ? stockData.bb_lower[dataIndex][1].toFixed(2) : 'N/A') + '<br/><br/>';
                            }
                            
                            // RSIæ•°æ®
                            if (stockData.rsi && stockData.rsi[dataIndex]) {
                                result += 'ğŸ“‰ <strong>RSI</strong><br/>';
                                result += '&nbsp;&nbsp;RSI: ' + (stockData.rsi[dataIndex][1] ? stockData.rsi[dataIndex][1].toFixed(2) : 'N/A') + '<br/><br/>';
                            }
                            
                            // MACDæ•°æ®
                            if (stockData.macd && stockData.macd.dif && stockData.macd.dif[dataIndex] && 
                                stockData.macd.dea && stockData.macd.dea[dataIndex] && 
                                stockData.macd.histogram && stockData.macd.histogram[dataIndex]) {
                                result += 'ğŸ“ˆ <strong>MACD</strong><br/>';
                                result += '&nbsp;&nbsp;DIF: ' + (stockData.macd.dif[dataIndex][1] ? stockData.macd.dif[dataIndex][1].toFixed(2) : 'N/A') + '<br/>';
                                result += '&nbsp;&nbsp;DEA: ' + (stockData.macd.dea[dataIndex][1] ? stockData.macd.dea[dataIndex][1].toFixed(2) : 'N/A') + '<br/>';
                                result += '&nbsp;&nbsp;æŸ±çŠ¶å›¾: ' + (stockData.macd.histogram[dataIndex][1] ? stockData.macd.histogram[dataIndex][1].toFixed(2) : 'N/A') + '<br/><br/>';
                            }
                            
                            // ğŸ†• åˆ†çº¢ä¿¡æ¯
                            if (stockData.dividends && stockData.dividends.length > 0) {
                                // æŸ¥æ‰¾å½“å‰æ—¶é—´ç‚¹çš„åˆ†çº¢äº‹ä»¶
                                const currentTimestamp = stockData.kline[dataIndex][0];
                                const dividendEvent = stockData.dividends.find(div => div.timestamp === currentTimestamp);
                                
                                if (dividendEvent) {
                                    result += 'ğŸ’° <strong>åˆ†çº¢ä¿¡æ¯</strong><br/>';
                                    
                                    if (dividendEvent.dividend_amount > 0) {
                                        result += '&nbsp;&nbsp;ğŸ’µ ç°é‡‘åˆ†çº¢: ' + dividendEvent.dividend_amount.toFixed(3) + 'å…ƒ/è‚¡<br/>';
                                    }
                                    if (dividendEvent.bonus_ratio > 0) {
                                        result += '&nbsp;&nbsp;ğŸ é€è‚¡æ¯”ä¾‹: ' + dividendEvent.bonus_ratio.toFixed(3) + '<br/>';
                                    }
                                    if (dividendEvent.transfer_ratio > 0) {
                                        result += '&nbsp;&nbsp;ğŸ“ˆ è½¬å¢æ¯”ä¾‹: ' + dividendEvent.transfer_ratio.toFixed(3) + '<br/>';
                                    }
                                    
                                    result += '&nbsp;&nbsp;ğŸ“… é™¤æƒæ—¥: ' + dividendEvent.date + '<br/>';
                                    result += '<br/>';
                                }
                            }
                        }
                        
                        return result;
                    }
                },
                legend: {
                    data: ['Kçº¿', 'å¸ƒæ—ä¸Šè½¨(ä¸»å›¾)', 'å¸ƒæ—ä¸­è½¨(ä¸»å›¾)', 'å¸ƒæ—ä¸‹è½¨(ä¸»å›¾)', 'ä»·å€¼æ¯”', 'RSI', 'MACD', 'MACDä¿¡å·çº¿', 'MACDæŸ±çŠ¶å›¾', 'ä¹°å…¥ç‚¹', 'å–å‡ºç‚¹', 'æœªæ‰§è¡Œä¹°å…¥', 'æœªæ‰§è¡Œå–å‡º', 'åˆ†çº¢æ ‡å¿—'],
                    top: 30
                },
                grid: [
                    {
                        left: '10%',
                        right: '10%',
                        top: '8%',
                        height: '18%'
                    },
                    {
                        left: '10%',
                        right: '10%',
                        top: '28%',
                        height: '18%'
                    },
                    {
                        left: '10%',
                        right: '10%',
                        top: '48%',
                        height: '18%'
                    },
                    {
                        left: '10%',
                        right: '10%',
                        top: '68%',
                        height: '18%'
                    }
                ],
                xAxis: [
                    {
                        type: 'category',
                        data: klinePoints.map(point => {
                            const date = new Date(point[0]);
                            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        }),
                        scale: true,
                        boundaryGap: false,
                        axisLine: { onZero: false },
                        splitLine: { show: false },
                        axisLabel: { 
                            show: true,
                            rotate: 0,
                            interval: 'auto'
                        }
                    },
                    {
                        type: 'category',
                        data: klinePoints.map(point => {
                            const date = new Date(point[0]);
                            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        }),
                        scale: true,
                        boundaryGap: false,
                        axisLine: { onZero: false },
                        splitLine: { show: false },
                        axisLabel: { show: false },
                        gridIndex: 1
                    },
                    {
                        type: 'category',
                        data: klinePoints.map(point => {
                            const date = new Date(point[0]);
                            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        }),
                        scale: true,
                        boundaryGap: false,
                        axisLine: { onZero: false },
                        splitLine: { show: false },
                        axisLabel: { show: false },
                        gridIndex: 2
                    },
                    {
                        type: 'category',
                        data: klinePoints.map(point => {
                            const date = new Date(point[0]);
                            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                        }),
                        scale: true,
                        boundaryGap: false,
                        axisLine: { onZero: false },
                        splitLine: { show: false },
                        axisLabel: { 
                            show: true,
                            rotate: 0,
                            interval: 'auto'
                        },
                        gridIndex: 3
                    }
                ],
                yAxis: [
                    {
                        scale: true,
                        splitArea: {
                            show: true
                        }
                    },
                    {
                        scale: true,
                        gridIndex: 1,
                        min: function(value) {
                            return Math.max(0, Math.floor(value.min * 0.9));
                        },
                        max: function(value) {
                            return Math.ceil(value.max * 1.1);
                        },
                        name: 'ä»·å€¼æ¯”(%)',
                        nameLocation: 'middle',
                        nameGap: 50
                    },
                    {
                        scale: true,
                        gridIndex: 2,
                        min: 0,
                        max: 100
                    },
                    {
                        scale: true,
                        gridIndex: 3
                    }
                ],
                dataZoom: [
                    {
                        type: 'inside',
                        start: 0,
                        end: 100,
                        xAxisIndex: [0, 1, 2, 3],
                        filterMode: 'none'
                    },
                    {
                        show: true,
                        type: 'slider',
                        top: '96%',
                        start: 0,
                        end: 100,
                        xAxisIndex: [0, 1, 2, 3],
                        filterMode: 'none'
                    }
                ],
                series: [
                    {
                        name: 'Kçº¿',
                        type: 'candlestick',
                        data: klinePoints.map(point => [point[1], point[2], point[3], point[4]]),
                        itemStyle: {
                            color: '#e53e3e',      // é˜³çº¿ï¼ˆæ¶¨ï¼‰- çº¢è‰²
                            color0: '#38a169',     // é˜´çº¿ï¼ˆè·Œï¼‰- ç»¿è‰²
                            borderColor: '#e53e3e',    // é˜³çº¿è¾¹æ¡†
                            borderColor0: '#38a169'    // é˜´çº¿è¾¹æ¡†
                        }
                    },
                    // Kçº¿ä¸»å›¾ä¸Šçš„å¸ƒæ—å¸¦
                    {
                        name: 'å¸ƒæ—ä¸Šè½¨(ä¸»å›¾)',
                        type: 'line',
                        data: bbUpperPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#1e90ff',
                            width: 1,
                            type: 'dashed'
                        },
                        symbol: 'none',
                        showSymbol: false
                    },
                    {
                        name: 'å¸ƒæ—ä¸­è½¨(ä¸»å›¾)',
                        type: 'line',
                        data: bbMiddlePoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#ffa500',
                            width: 1.5
                        },
                        symbol: 'none',
                        showSymbol: false
                    },
                    {
                        name: 'å¸ƒæ—ä¸‹è½¨(ä¸»å›¾)',
                        type: 'line',
                        data: bbLowerPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#1e90ff',
                            width: 1,
                            type: 'dashed'
                        },
                        symbol: 'none',
                        showSymbol: false
                    },
                    {
                        name: 'ä¹°å…¥ç‚¹',
                        type: 'scatter',
                        data: buyPoints.map((point, index) => {
                            const categoryIndex = klinePoints.findIndex(kpoint => kpoint[0] === point[0]);
                            return [categoryIndex, point[1]];
                        }),
                        symbol: 'triangle',
                        symbolSize: 10,
                        itemStyle: {
                            color: '#e53e3e',
                            borderColor: '#ffffff',
                            borderWidth: 3,
                            shadowColor: '#e53e3e',
                            shadowBlur: 10
                        },
                        label: {
                            show: true,
                            position: 'bottom',
                            formatter: 'ä¹°å…¥',
                            color: '#ffffff',
                            fontSize: 12,
                            fontWeight: 'bold',
                            backgroundColor: '#e53e3e',
                            padding: [4, 8],
                            borderRadius: 4
                        },
                        z: 100
                    },
                    {
                        name: 'å–å‡ºç‚¹',
                        type: 'scatter',
                        data: sellPoints.map((point, index) => {
                            const categoryIndex = klinePoints.findIndex(kpoint => kpoint[0] === point[0]);
                            return [categoryIndex, point[1]];
                        }),
                        symbol: 'triangle',
                        symbolRotate: 180,
                        symbolSize: 10,
                        itemStyle: {
                            color: '#38a169',
                            borderColor: '#ffffff',
                            borderWidth: 3,
                            shadowColor: '#38a169',
                            shadowBlur: 10
                        },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: 'å–å‡º',
                            color: '#ffffff',
                            fontSize: 12,
                            fontWeight: 'bold',
                            backgroundColor: '#38a169',
                            padding: [4, 8],
                            borderRadius: 4
                        },
                        z: 100
                    },
                    // ğŸ†• åˆ†çº¢æ ‡å¿—ç³»åˆ—
                    {
                        name: 'åˆ†çº¢æ ‡å¿—',
                        type: 'scatter',
                        data: dividendPoints.map((point, index) => {
                            const categoryIndex = klinePoints.findIndex(kpoint => kpoint[0] === point[0]);
                            return [categoryIndex, point[1]];
                        }),
                        symbol: 'diamond',
                        symbolSize: 8,
                        itemStyle: {
                            color: '#ff6b35',
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            shadowColor: '#ff6b35',
                            shadowBlur: 8
                        },
                        label: {
                            show: true,
                            position: 'bottom',
                            formatter: 'ğŸ’°',
                            color: '#ff6b35',
                            fontSize: 14,
                            fontWeight: 'bold',
                            backgroundColor: '#ffffff',
                            padding: [2, 4],
                            borderRadius: 3,
                            borderColor: '#ff6b35',
                            borderWidth: 1
                        },
                        z: 90
                    },
                    // ä»·å€¼æ¯”å­å›¾ç³»åˆ—
                    {
                        name: 'ä»·å€¼æ¯”',
                        type: 'line',
                        data: pvrPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#ff6b35',
                            width: 3,
                            shadowColor: 'rgba(255, 107, 53, 0.3)',
                            shadowBlur: 4,
                            shadowOffsetY: 2
                        },
                        symbol: 'none',
                        xAxisIndex: 1,
                        yAxisIndex: 1,
                        z: 110,
                        markLine: {
                            silent: true,
                            data: [
                                {
                                    yAxis: 100,
                                    lineStyle: {
                                        color: '#333',
                                        type: 'solid',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'åˆç†ä¼°å€¼(100%)'
                                    }
                                },
                                {
                                    yAxis: 70,
                                    lineStyle: {
                                        color: '#2ed573',
                                        type: 'dashed',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'å®‰å…¨è¾¹é™…(70%)'
                                    }
                                },
                                {
                                    yAxis: 120,
                                    lineStyle: {
                                        color: '#ff4757',
                                        type: 'dashed',
                                        width: 1
                                    },
                                    label: {
                                        show: true,
                                        position: 'end',
                                        formatter: 'é«˜ä¼°è­¦æˆ’(120%)'
                                    }
                                }
                            ]
                        }
                    },
                    // RSIå­å›¾ç³»åˆ—
                    {
                        name: 'RSI',
                        type: 'line',
                        data: rsiPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#800080',
                            width: 1
                        },
                        symbol: 'none',
                        xAxisIndex: 2,
                        yAxisIndex: 2
                    },
                    // MACDå­å›¾ç³»åˆ—
                    {
                        name: 'MACD',
                        type: 'line',
                        data: macdPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#ff0000',
                            width: 1
                        },
                        symbol: 'none',
                        xAxisIndex: 3,
                        yAxisIndex: 3
                    },
                    {
                        name: 'MACDä¿¡å·çº¿',
                        type: 'line',
                        data: macdSignalPoints.map(point => point[1]),
                        smooth: true,
                        lineStyle: {
                            color: '#0000ff',
                            width: 1
                        },
                        symbol: 'none',
                        xAxisIndex: 3,
                        yAxisIndex: 3
                    },
                    {
                        name: 'MACDæŸ±çŠ¶å›¾',
                        type: 'bar',
                        data: macdHistogramPoints.map(point => point[1]),
                        itemStyle: {
                            color: function(params) {
                                return params.value >= 0 ? '#e53e3e' : '#38a169';
                            }
                        },
                        xAxisIndex: 3,
                        yAxisIndex: 3
                    },
                    // ğŸ†• æœªæ‰§è¡Œä¹°å…¥ä¿¡å·ç³»åˆ—
                    {
                        name: 'æœªæ‰§è¡Œä¹°å…¥',
                        type: 'scatter',
                        data: unexecutedBuyPoints.map((point, index) => {
                            const categoryIndex = klinePoints.findIndex(kpoint => kpoint[0] === point[0]);
                            if (categoryIndex === -1) {
                                console.log('æœªæ‰¾åˆ°åŒ¹é…çš„Kçº¿æ•°æ®ç‚¹:', point[0], new Date(point[0]));
                                return null;
                            }
                            return [categoryIndex, point[1]];
                        }).filter(point => point !== null),
                        symbol: 'emptyCircle',
                        symbolSize: 12,
                        color: '#ff6b7a',
                        itemStyle: {
                            color: '#ff6b7a',
                            borderColor: '#ff6b7a',
                            borderWidth: 2
                        },
                        label: {
                            show: true,
                            position: 'top',
                            formatter: 'æœªæ‰§è¡Œä¹°å…¥',
                            color: '#ff6b7a',
                            fontSize: 10,
                            fontWeight: 'bold',
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            padding: [2, 4],
                            borderRadius: 3
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: function(params) {
                                const pointIndex = params.dataIndex;
                                
                                // ä½¿ç”¨åŸå§‹æœªæ‰§è¡Œä¿¡å·æ•°æ®æ¥æŸ¥æ‰¾åŸå› 
                                let reason = 'æœªçŸ¥åŸå› ';
                                if (typeof unexecutedSignals !== 'undefined' && unexecutedSignals[selectedStock]) {
                                    const buySignals = unexecutedSignals[selectedStock].filter(s => s.signal_type === 'BUY');
                                    if (pointIndex < buySignals.length && buySignals[pointIndex]) {
                                        reason = buySignals[pointIndex].reason || 'æœªçŸ¥åŸå› ';
                                    }
                                }
                                
                                return 'æœªæ‰§è¡Œä¹°å…¥ä¿¡å·<br/>åŸå› : ' + reason;
                            }
                        },
                        z: 95
                    },
                    // ğŸ†• æœªæ‰§è¡Œå–å‡ºä¿¡å·ç³»åˆ—
                    {
                        name: 'æœªæ‰§è¡Œå–å‡º',
                        type: 'scatter',
                        data: unexecutedSellPoints.map((point, index) => {
                            const categoryIndex = klinePoints.findIndex(kpoint => kpoint[0] === point[0]);
                            if (categoryIndex === -1) {
                                console.log('æœªæ‰¾åˆ°åŒ¹é…çš„Kçº¿æ•°æ®ç‚¹:', point[0], new Date(point[0]));
                                return null;
                            }
                            return [categoryIndex, point[1]];
                        }).filter(point => point !== null),
                        symbol: 'emptyCircle',
                        symbolSize: 12,
                        color: '#7bed9f',
                        itemStyle: {
                            color: '#7bed9f',
                            borderColor: '#7bed9f',
                            borderWidth: 2
                        },
                        label: {
                            show: true,
                            position: 'bottom',
                            formatter: 'æœªæ‰§è¡Œå–å‡º',
                            color: '#7bed9f',
                            fontSize: 10,
                            fontWeight: 'bold',
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            padding: [2, 4],
                            borderRadius: 3
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: function(params) {
                                const pointIndex = params.dataIndex;
                                
                                // ä½¿ç”¨åŸå§‹æœªæ‰§è¡Œä¿¡å·æ•°æ®æ¥æŸ¥æ‰¾åŸå› 
                                let reason = 'æœªçŸ¥åŸå› ';
                                if (typeof unexecutedSignals !== 'undefined' && unexecutedSignals[selectedStock]) {
                                    const sellSignals = unexecutedSignals[selectedStock].filter(s => s.signal_type === 'SELL');
                                    if (pointIndex < sellSignals.length && sellSignals[pointIndex]) {
                                        reason = sellSignals[pointIndex].reason || 'æœªçŸ¥åŸå› ';
                                    }
                                }
                                
                                return 'æœªæ‰§è¡Œå–å‡ºä¿¡å·<br/>åŸå› : ' + reason;
                            }
                        },
                        z: 95
                    }
                ]
            };
            
            klineChart.setOption(option);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initStockSelector();
        });
        
        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°è°ƒæ•´å›¾è¡¨
        window.addEventListener('resize', function() {
            klineChart.resize();
        });
    </script>
</body>
</html>