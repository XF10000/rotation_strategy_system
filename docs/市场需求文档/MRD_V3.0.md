### **中线行业轮动策略市场需求文档 (MRD) - V3.0**

**版本**: 3.0
**日期**: 2025-08-09
**状态**: **定稿**

### 1. 产品概述

#### 1.1. 产品愿景
打造一个**智能、自适应**的中线量化交易策略系统。该系统旨在通过结合**基本面价值筛选**与**多维度技术择时**，在申万二级行业的轮动中，持续捕捉高确定性的交易机会。

#### 1.2. 核心理念
策略的基石是“先选好公司，再等好时机”。我们坚信，只有在**价值合理**的前提下，技术信号才有意义。因此，本策略以**价值比率**作为硬性准入门槛，并辅以一套**数据驱动的动态信号系统**进行精准择时。

#### 1.3. 目标用户
- **产品经理**: 理解策略核心逻辑与竞争优势。
- **技术负责人**: 把握系统架构、模块划分与技术实现。
- **量化分析师**: 使用并优化策略参数，进行深度归因分析。

---

### 2. 核心策略逻辑：4D决策框架

策略的决策核心是一个四维信号系统，它以层层递进的方式进行过滤和确认，以确保信号的高质量。

#### **维度一：价值准入过滤器 (硬性前提)**
这是信号系统的**唯一硬性前提**，所有交易机会必须首先通过此关。

- **主规则**: 基于DCF（现金流折现）估值计算**价值比率** (`当前市值 / DCF估值`)。
  - **买入条件**: `价值比率 < 70%` (处于低估区间)
  - **卖出条件**: `价值比率 > 80%` (处于高估或合理区间)
- **兼容性回退**: 当目标缺少DCF估值数据时，系统自动无缝切换到**“20周EMA趋势过滤器”**，确保策略的普适性。

#### **维度二、三、四：技术择时信号 (三者取二)**
在满足【维度一】的前提下，以下三个技术维度中**至少满足两个**，才能最终触发交易信号。

- **维度二：超买超卖 (动态RSI系统)**
  - **机制**: 摒弃固定的30/70阈值，采用一套**数据驱动的动态阈值系统**。该系统通过分析行业历史波动率，自动将行业分为“高/中/低”三层，并根据其历史RSI分布的**分位数**来计算超买超卖阈值。
  - **信号**:
    - **普通信号**: RSI触达为该行业计算出的普通阈值，且出现价格背离。
    - **极端信号**: RSI触达更严格的极端阈值，**此时无需背离**，直接触发。

- **维度三：动能确认 (MACD)**
  - **机制**: 判断市场动能的转换。
  - **信号**:
    - **买入**: MACD柱状线由负转正，或出现金叉。
    - **卖出**: MACD柱状线由正转负，或出现死叉。

- **维度四：极端放量 (布林带 + 成交量)**
  - **机制**: 捕捉由资金驱动的极端情绪爆发点。
  - **信号**:
    - **买入**: 价格跌破布林带下轨，且成交量显著放大。
    - **卖出**: 价格突破布林带上轨，且成交量显著放大。

---

### 3. 系统架构与交付物

#### 3.1. 系统核心组件
- **回测引擎 (`BacktestEngine`)**: 负责数据加载（内置智能缓存）、回测流程调度、与信号生成器的交互。
- **信号生成器 (`SignalGenerator`)**: 封装完整的4D决策框架逻辑。
- **动态RSI阈值模块 (`sw_rsi_thresholds/`)**: 一个独立的预处理模块，负责定期计算并生成最新的行业RSI阈值CSV文件，供回测引擎调用。

#### 3.2. 关键交付物
- **可执行的回测框架**: 一整套Python代码，可直接运行。
- **详尽的回测报告**:
  - **HTML报告**: 提供资金曲线、夏普比率、最大回撤等关键指标的可视化概览。
  - **CSV报告**: 提供每一笔交易的明细，包括触发交易时所有四个维度的详细状态，便于深度归因分析。
- **完备的文档**: 包括本MRD、用户使用指南和代码注释。
